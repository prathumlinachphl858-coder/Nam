-- ================= LOAD RAYFIELD =================
local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

local Window = Rayfield:CreateWindow({
    Name = "NamX Control Hub",
    LoadingTitle = "NamX Control Hub",
    LoadingSubtitle = "by Nam",
    ConfigurationSaving = { Enabled = false },
    KeySystem = false
})

local ESPTab   = Window:CreateTab("ESP", 4483362458)
local AimTab   = Window:CreateTab("Aimbot", 4483362458)
local PerfTab  = Window:CreateTab("Performance", 4483362458)
local MiscTab  = Window:CreateTab("Misc", 4483362458)

-- ================= SERVICES =================
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer
local Lighting = game:GetService("Lighting")

-- =================================================
-- ======================= ESP =====================
-- =================================================
local ESP_ENABLED = false
local BOX_ENABLED = true
local LINE_ENABLED = true
local HEALTH_ENABLED = true
local DIST_ENABLED = true
local SKELETON_ENABLED = true
local TEAM_CHECK_ESP = true

local ESP_TABLE = {}

local function newLine(thick)
    local l = Drawing.new("Line")
    l.Thickness = thick or 1
    l.Visible = false
    return l
end

local function createESP(player)
    if player == LocalPlayer then return end

    local box = Drawing.new("Square")
    box.Filled = false
    box.Thickness = 1
    box.Visible = false

    local tracer = newLine(1)
    local health = newLine(3)

    local dist = Drawing.new("Text")
    dist.Size = 12
    dist.Center = true
    dist.Outline = true
    dist.Visible = false

    local skeleton = {
        head = newLine(1),
        torso = newLine(1),
        larm = newLine(1),
        rarm = newLine(1),
        lleg = newLine(1),
        rleg = newLine(1),
    }

    ESP_TABLE[player] = {
        box = box,
        tracer = tracer,
        health = health,
        dist = dist,
        skeleton = skeleton
    }
end

local function removeESP(player)
    if ESP_TABLE[player] then
        for _,v in pairs(ESP_TABLE[player]) do
            if typeof(v) == "table" then
                for _,l in pairs(v) do l:Remove() end
            else
                v:Remove()
            end
        end
        ESP_TABLE[player] = nil
    end
end

for _,p in ipairs(Players:GetPlayers()) do createESP(p) end
Players.PlayerAdded:Connect(createESP)
Players.PlayerRemoving:Connect(removeESP)

RunService.RenderStepped:Connect(function()
    local myChar = LocalPlayer.Character
    local myHRP = myChar and myChar:FindFirstChild("HumanoidRootPart")

    for player,esp in pairs(ESP_TABLE) do
        -- üî¥ ‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô (‡πÅ‡∏Å‡πâ‡∏Ñ‡πâ‡∏≤‡∏á)
        esp.box.Visible = false
        esp.tracer.Visible = false
        esp.health.Visible = false
        esp.dist.Visible = false
        for _,l in pairs(esp.skeleton) do l.Visible = false end

        if not ESP_ENABLED then continue end

        local char = player.Character
        local hum = char and char:FindFirstChildOfClass("Humanoid")
        local hrp = char and char:FindFirstChild("HumanoidRootPart")
        if not hum or hum.Health <= 0 or not hrp then continue end
        if TEAM_CHECK_ESP and player.Team == LocalPlayer.Team then continue end

        local pos,on = Camera:WorldToViewportPoint(hrp.Position)
        if not on then continue end

        local color = (player.Team == LocalPlayer.Team)
            and Color3.fromRGB(0,255,0)
            or Color3.fromRGB(255,0,0)

        local size = Vector2.new(2000/pos.Z,3000/pos.Z)
        local x,y = pos.X-size.X/2,pos.Y-size.Y/2

        if BOX_ENABLED then
            esp.box.Size = size
            esp.box.Position = Vector2.new(x,y)
            esp.box.Color = color
            esp.box.Visible = true
        end

        if LINE_ENABLED then
            esp.tracer.From = Vector2.new(Camera.ViewportSize.X/2,Camera.ViewportSize.Y)
            esp.tracer.To = Vector2.new(pos.X,pos.Y)
            esp.tracer.Color = color
            esp.tracer.Visible = true
        end

        if HEALTH_ENABLED then
            local hp = hum.Health/hum.MaxHealth
            esp.health.From = Vector2.new(x-5,y+size.Y)
            esp.health.To = Vector2.new(x-5,y+size.Y-(size.Y*hp))
            esp.health.Color = Color3.fromRGB(0,255,0)
            esp.health.Visible = true
        end

        if DIST_ENABLED and myHRP then
            esp.dist.Text = math.floor((myHRP.Position-hrp.Position).Magnitude).." studs"
            esp.dist.Position = Vector2.new(pos.X,y-12)
            esp.dist.Color = color
            esp.dist.Visible = true
        end
    end
end)

-- ================= ESP UI =================
ESPTab:CreateToggle({Name="Enable ESP",CurrentValue=false,Callback=function(v) ESP_ENABLED=v end})
ESPTab:CreateToggle({Name="Box",CurrentValue=true,Callback=function(v) BOX_ENABLED=v end})
ESPTab:CreateToggle({Name="Line",CurrentValue=true,Callback=function(v) LINE_ENABLED=v end})
ESPTab:CreateToggle({Name="Health Bar",CurrentValue=true,Callback=function(v) HEALTH_ENABLED=v end})
ESPTab:CreateToggle({Name="Distance",CurrentValue=true,Callback=function(v) DIST_ENABLED=v end})
ESPTab:CreateToggle({Name="Team Check",CurrentValue=true,Callback=function(v) TEAM_CHECK_ESP=v end})

-- =================================================
-- ===================== AIMBOT ====================
-- =================================================
local AimbotEnabled = false
local WallCheck = true
local TeamCheckAim = true
local AimPart = "Head"
local Strength = 1 -- ‡πÅ‡∏£‡∏á‡∏°‡∏≤‡∏Å

local function Visible(part)
    local params = RaycastParams.new()
    params.FilterType = Enum.RaycastFilterType.Blacklist
    params.FilterDescendantsInstances = {LocalPlayer.Character, Camera}
    local ray = workspace:Raycast(Camera.CFrame.Position, (part.Position-Camera.CFrame.Position), params)
    return ray and ray.Instance:IsDescendantOf(part.Parent)
end

RunService.RenderStepped:Connect(function()
    if not AimbotEnabled then return end

    local closest,dist = nil,math.huge
    for _,plr in ipairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild(AimPart) then
            if not TeamCheckAim or plr.Team ~= LocalPlayer.Team then
                local hum = plr.Character:FindFirstChildOfClass("Humanoid")
                local part = plr.Character[AimPart]
                if hum and hum.Health > 0 then
                    if not WallCheck or Visible(part) then
                        local d = (part.Position - Camera.CFrame.Position).Magnitude
                        if d < dist then
                            dist = d
                            closest = part
                        end
                    end
                end
            end
        end
    end

    if closest then
        Camera.CFrame = Camera.CFrame:Lerp(
            CFrame.new(Camera.CFrame.Position, closest.Position),
            Strength
        )
    end
end)

AimTab:CreateToggle({Name="Enable Aimbot",CurrentValue=false,Callback=function(v) AimbotEnabled=v end})
AimTab:CreateToggle({Name="Wall Check",CurrentValue=true,Callback=function(v) WallCheck=v end})
AimTab:CreateToggle({Name="Team Check",CurrentValue=true,Callback=function(v) TeamCheckAim=v end})
AimTab:CreateButton({Name="Switch Aim Part",Callback=function()
    AimPart = (AimPart=="Head") and "HumanoidRootPart" or "Head"
end})

-- =================================================
-- ================= FPS BOOST =====================
-- =================================================
PerfTab:CreateButton({
    Name="Boost FPS (Ultra)",
    Callback=function()
        Lighting.GlobalShadows = false
        settings().Rendering.QualityLevel = 1
        for _,v in pairs(workspace:GetDescendants()) do
            if v:IsA("BasePart") then
                v.Material = Enum.Material.Plastic
                v.Reflectance = 0
            end
        end
    end
})
